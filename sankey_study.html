<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Study Sankey</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@6.0.0/dist/echarts.min.js"></script>
  <style>
    body { 
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; 
      margin: 24px; 
    }
    h1 { 
      font-size: 20px; 
      margin: 0 0 8px; 
    }
    .controls { 
      display: flex; 
      flex-wrap: wrap; 
      gap: 12px; 
      align-items: center; 
      margin-bottom: 12px; 
    }
    .controls label { 
      font-weight: 600; 
      font-size: 14px; 
      margin-right: 6px; 
    }
    select { 
      padding: 6px 8px; 
      border-radius: 8px; 
      border: 1px solid #ccc; 
    }
    #chart { 
      width: 100%; 
      height: 590px; 
    }
    .pill { 
      display:inline-block; 
      padding:6px 8px; 
      border:1px solid #ccc; 
      border-radius:999px; 
      margin-left:6px; 
      font-size:14px; 
      color:#333; 
    }
    
    /* Navigation */
    .nav {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 12px 24px;
      margin: -24px -24px 20px -24px;
      display: flex;
      gap: 16px;
      align-items: center;
      flex-wrap: wrap;
    }
    .nav a {
      color: white;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      padding: 6px 12px;
      border-radius: 6px;
      transition: background 0.2s;
    }
    .nav a:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    .nav a.active {
      background: rgba(255, 255, 255, 0.3);
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="nav">
    <a href="index.html">← Home</a>
    <a href="sankey_imp.html">IMP Sankey</a>
    <a href="sankey_tfw.html">TFW Sankey</a>
    <a href="sankey_pr.html">PR Sankey</a>
    <a href="sankey_asylum.html">Asylum Sankey</a>
    <a href="sankey_study.html" class="active">Study Sankey</a>
  </div>
  <h1>Study Sankey</h1>
  <div class="controls">
    <div>
      <label for="provinceSelect">Province/Territory</label>
      <select id="provinceSelect">
        <option value="ALL" selected>All</option>
      </select>
    </div>
    <div>
      <label for="yearSelect">Year</label>
      <select id="yearSelect">
        <option value="ALL" selected>All</option>
      </select>
    </div>
    <span id="summary" class="pill">All provinces · All years</span>
  </div>
  <div id="chart"></div>
  <div id="zeroValues" style="display: none; margin-top: 20px; padding: 16px; clear: both; position: relative; z-index: 1;">
    <h3 style="margin: 0 0 12px 0; font-size: 16px; color: #495057;">Zero Value Categories</h3>
    <div id="zeroValuesList" style="display: flex; flex-wrap: wrap; gap: 8px;"></div>
  </div>

  <!-- The Python script will inject data below by replacing the placeholders. -->
  <script>
    // BEGIN DATA (auto-generated — do not edit by hand)
    const NODES = ["Study", "Education level not stated", "Other Studies", "Post Secondary", "Secondary or less"];
    const LINKS = [{"source": "Study", "target": "Education level not stated", "value": 16, "province_territory": "Alberta", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 1935, "province_territory": "Alberta", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 8950, "province_territory": "Alberta", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 4355, "province_territory": "Alberta", "year": "2015"}, {"source": "Study", "target": "Education level not stated", "value": 44, "province_territory": "British Columbia", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 10140, "province_territory": "British Columbia", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 30985, "province_territory": "British Columbia", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 17855, "province_territory": "British Columbia", "year": "2015"}, {"source": "Study", "target": "Education level not stated", "value": 6, "province_territory": "Manitoba", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 745, "province_territory": "Manitoba", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 5375, "province_territory": "Manitoba", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 1080, "province_territory": "Manitoba", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 131, "province_territory": "New Brunswick", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 1830, "province_territory": "New Brunswick", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 435, "province_territory": "New Brunswick", "year": "2015"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Newfoundland and Labrador", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 88, "province_territory": "Newfoundland and Labrador", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 1420, "province_territory": "Newfoundland and Labrador", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 182, "province_territory": "Newfoundland and Labrador", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 8, "province_territory": "Northwest Territories", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 15, "province_territory": "Northwest Territories", "year": "2015"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Nova Scotia", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 895, "province_territory": "Nova Scotia", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 4310, "province_territory": "Nova Scotia", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 1240, "province_territory": "Nova Scotia", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 2, "province_territory": "Nunavut", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 2, "province_territory": "Nunavut", "year": "2015"}, {"source": "Study", "target": "Education level not stated", "value": 52, "province_territory": "Ontario", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 12295, "province_territory": "Ontario", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 65610, "province_territory": "Ontario", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 21860, "province_territory": "Ontario", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 232, "province_territory": "Prince Edward Island", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 510, "province_territory": "Prince Edward Island", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 179, "province_territory": "Prince Edward Island", "year": "2015"}, {"source": "Study", "target": "Education level not stated", "value": 30, "province_territory": "Province/territory not stated Total", "year": "2015"}, {"source": "Study", "target": "Education level not stated", "value": 22, "province_territory": "Quebec", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 3355, "province_territory": "Quebec", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 25400, "province_territory": "Quebec", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 2615, "province_territory": "Quebec", "year": "2015"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Saskatchewan", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 275, "province_territory": "Saskatchewan", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 2775, "province_territory": "Saskatchewan", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 1005, "province_territory": "Saskatchewan", "year": "2015"}, {"source": "Study", "target": "Other Studies", "value": 6, "province_territory": "Yukon", "year": "2015"}, {"source": "Study", "target": "Post Secondary", "value": 24, "province_territory": "Yukon", "year": "2015"}, {"source": "Study", "target": "Secondary or less", "value": 4, "province_territory": "Yukon", "year": "2015"}, {"source": "Study", "target": "Education level not stated", "value": 14, "province_territory": "Alberta", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 2150, "province_territory": "Alberta", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 10770, "province_territory": "Alberta", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 4165, "province_territory": "Alberta", "year": "2016"}, {"source": "Study", "target": "Education level not stated", "value": 38, "province_territory": "British Columbia", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 9935, "province_territory": "British Columbia", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 38600, "province_territory": "British Columbia", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 20125, "province_territory": "British Columbia", "year": "2016"}, {"source": "Study", "target": "Education level not stated", "value": 6, "province_territory": "Manitoba", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 1025, "province_territory": "Manitoba", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 6795, "province_territory": "Manitoba", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 1270, "province_territory": "Manitoba", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 238, "province_territory": "New Brunswick", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 1865, "province_territory": "New Brunswick", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 585, "province_territory": "New Brunswick", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 90, "province_territory": "Newfoundland and Labrador", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 1655, "province_territory": "Newfoundland and Labrador", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 310, "province_territory": "Newfoundland and Labrador", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 4, "province_territory": "Northwest Territories", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 21, "province_territory": "Northwest Territories", "year": "2016"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Nova Scotia", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 835, "province_territory": "Nova Scotia", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 4985, "province_territory": "Nova Scotia", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 1465, "province_territory": "Nova Scotia", "year": "2016"}, {"source": "Study", "target": "Education level not stated", "value": 44, "province_territory": "Ontario", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 14780, "province_territory": "Ontario", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 88395, "province_territory": "Ontario", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 25795, "province_territory": "Ontario", "year": "2016"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Prince Edward Island", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 227, "province_territory": "Prince Edward Island", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 765, "province_territory": "Prince Edward Island", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 215, "province_territory": "Prince Edward Island", "year": "2016"}, {"source": "Study", "target": "Education level not stated", "value": 117, "province_territory": "Province/territory not stated Total", "year": "2016"}, {"source": "Study", "target": "Education level not stated", "value": 20, "province_territory": "Quebec", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 4195, "province_territory": "Quebec", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 27515, "province_territory": "Quebec", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 3100, "province_territory": "Quebec", "year": "2016"}, {"source": "Study", "target": "Education level not stated", "value": 6, "province_territory": "Saskatchewan", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 275, "province_territory": "Saskatchewan", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 3195, "province_territory": "Saskatchewan", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 1050, "province_territory": "Saskatchewan", "year": "2016"}, {"source": "Study", "target": "Other Studies", "value": 11, "province_territory": "Yukon", "year": "2016"}, {"source": "Study", "target": "Post Secondary", "value": 35, "province_territory": "Yukon", "year": "2016"}, {"source": "Study", "target": "Secondary or less", "value": 12, "province_territory": "Yukon", "year": "2016"}, {"source": "Study", "target": "Education level not stated", "value": 12, "province_territory": "Alberta", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 2015, "province_territory": "Alberta", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 11155, "province_territory": "Alberta", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 4110, "province_territory": "Alberta", "year": "2017"}, {"source": "Study", "target": "Education level not stated", "value": 28, "province_territory": "British Columbia", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 11460, "province_territory": "British Columbia", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 47205, "province_territory": "British Columbia", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 20780, "province_territory": "British Columbia", "year": "2017"}, {"source": "Study", "target": "Education level not stated", "value": 8, "province_territory": "Manitoba", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 1380, "province_territory": "Manitoba", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 8080, "province_territory": "Manitoba", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 1545, "province_territory": "Manitoba", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 243, "province_territory": "New Brunswick", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 1985, "province_territory": "New Brunswick", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 740, "province_territory": "New Brunswick", "year": "2017"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Newfoundland and Labrador", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 145, "province_territory": "Newfoundland and Labrador", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 1815, "province_territory": "Newfoundland and Labrador", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 335, "province_territory": "Newfoundland and Labrador", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 6, "province_territory": "Northwest Territories", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 19, "province_territory": "Northwest Territories", "year": "2017"}, {"source": "Study", "target": "Education level not stated", "value": 6, "province_territory": "Nova Scotia", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 1240, "province_territory": "Nova Scotia", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 5205, "province_territory": "Nova Scotia", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 1625, "province_territory": "Nova Scotia", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 4, "province_territory": "Nunavut", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 2, "province_territory": "Nunavut", "year": "2017"}, {"source": "Study", "target": "Education level not stated", "value": 52, "province_territory": "Ontario", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 21115, "province_territory": "Ontario", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 110415, "province_territory": "Ontario", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 30115, "province_territory": "Ontario", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 285, "province_territory": "Prince Edward Island", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 930, "province_territory": "Prince Edward Island", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 270, "province_territory": "Prince Edward Island", "year": "2017"}, {"source": "Study", "target": "Education level not stated", "value": 92, "province_territory": "Province/territory not stated Total", "year": "2017"}, {"source": "Study", "target": "Education level not stated", "value": 14, "province_territory": "Quebec", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 5285, "province_territory": "Quebec", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 30450, "province_territory": "Quebec", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 3725, "province_territory": "Quebec", "year": "2017"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "Saskatchewan", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 445, "province_territory": "Saskatchewan", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 3275, "province_territory": "Saskatchewan", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 955, "province_territory": "Saskatchewan", "year": "2017"}, {"source": "Study", "target": "Other Studies", "value": 11, "province_territory": "Yukon", "year": "2017"}, {"source": "Study", "target": "Post Secondary", "value": 170, "province_territory": "Yukon", "year": "2017"}, {"source": "Study", "target": "Secondary or less", "value": 17, "province_territory": "Yukon", "year": "2017"}, {"source": "Study", "target": "Education level not stated", "value": 10, "province_territory": "Alberta", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 2015, "province_territory": "Alberta", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 13155, "province_territory": "Alberta", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 4105, "province_territory": "Alberta", "year": "2018"}, {"source": "Study", "target": "Education level not stated", "value": 31, "province_territory": "British Columbia", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 11450, "province_territory": "British Columbia", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 52900, "province_territory": "British Columbia", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 20225, "province_territory": "British Columbia", "year": "2018"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "Manitoba", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 1480, "province_territory": "Manitoba", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 9585, "province_territory": "Manitoba", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 1570, "province_territory": "Manitoba", "year": "2018"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "New Brunswick", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 405, "province_territory": "New Brunswick", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 2465, "province_territory": "New Brunswick", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 955, "province_territory": "New Brunswick", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 147, "province_territory": "Newfoundland and Labrador", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 1890, "province_territory": "Newfoundland and Labrador", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 342, "province_territory": "Newfoundland and Labrador", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 8, "province_territory": "Northwest Territories", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 24, "province_territory": "Northwest Territories", "year": "2018"}, {"source": "Study", "target": "Education level not stated", "value": 8, "province_territory": "Nova Scotia", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 1615, "province_territory": "Nova Scotia", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 6955, "province_territory": "Nova Scotia", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 1685, "province_territory": "Nova Scotia", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 4, "province_territory": "Nunavut", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 4, "province_territory": "Nunavut", "year": "2018"}, {"source": "Study", "target": "Education level not stated", "value": 54, "province_territory": "Ontario", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 23035, "province_territory": "Ontario", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 126310, "province_territory": "Ontario", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 31650, "province_territory": "Ontario", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 370, "province_territory": "Prince Edward Island", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 1085, "province_territory": "Prince Edward Island", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 450, "province_territory": "Prince Edward Island", "year": "2018"}, {"source": "Study", "target": "Education level not stated", "value": 940, "province_territory": "Province/territory not stated Total", "year": "2018"}, {"source": "Study", "target": "Education level not stated", "value": 21, "province_territory": "Quebec", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 5820, "province_territory": "Quebec", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 35425, "province_territory": "Quebec", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 4080, "province_territory": "Quebec", "year": "2018"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "Saskatchewan", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 670, "province_territory": "Saskatchewan", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 4325, "province_territory": "Saskatchewan", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 920, "province_territory": "Saskatchewan", "year": "2018"}, {"source": "Study", "target": "Other Studies", "value": 6, "province_territory": "Yukon", "year": "2018"}, {"source": "Study", "target": "Post Secondary", "value": 53, "province_territory": "Yukon", "year": "2018"}, {"source": "Study", "target": "Secondary or less", "value": 15, "province_territory": "Yukon", "year": "2018"}, {"source": "Study", "target": "Education level not stated", "value": 30, "province_territory": "Alberta", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 1740, "province_territory": "Alberta", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 14455, "province_territory": "Alberta", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 4790, "province_territory": "Alberta", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 29, "province_territory": "British Columbia", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 10150, "province_territory": "British Columbia", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 57995, "province_territory": "British Columbia", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 20610, "province_territory": "British Columbia", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 6, "province_territory": "Manitoba", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 1080, "province_territory": "Manitoba", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 9835, "province_territory": "Manitoba", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 1755, "province_territory": "Manitoba", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "New Brunswick", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 207, "province_territory": "New Brunswick", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 3190, "province_territory": "New Brunswick", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 1025, "province_territory": "New Brunswick", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 118, "province_territory": "Newfoundland and Labrador", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 2185, "province_territory": "Newfoundland and Labrador", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 375, "province_territory": "Newfoundland and Labrador", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 4, "province_territory": "Northwest Territories", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 28, "province_territory": "Northwest Territories", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 14, "province_territory": "Nova Scotia", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 1470, "province_territory": "Nova Scotia", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 7345, "province_territory": "Nova Scotia", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 1790, "province_territory": "Nova Scotia", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 8, "province_territory": "Nunavut", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 2, "province_territory": "Nunavut", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 57, "province_territory": "Ontario", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 20815, "province_territory": "Ontario", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 149245, "province_territory": "Ontario", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 33930, "province_territory": "Ontario", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Prince Edward Island", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 240, "province_territory": "Prince Edward Island", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 1275, "province_territory": "Prince Edward Island", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 415, "province_territory": "Prince Edward Island", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 1785, "province_territory": "Province/territory not stated Total", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 13, "province_territory": "Quebec", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 7130, "province_territory": "Quebec", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 45835, "province_territory": "Quebec", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 5635, "province_territory": "Quebec", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 6, "province_territory": "Saskatchewan", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 520, "province_territory": "Saskatchewan", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 4755, "province_territory": "Saskatchewan", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 1130, "province_territory": "Saskatchewan", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Yukon", "year": "2019"}, {"source": "Study", "target": "Other Studies", "value": 14, "province_territory": "Yukon", "year": "2019"}, {"source": "Study", "target": "Post Secondary", "value": 85, "province_territory": "Yukon", "year": "2019"}, {"source": "Study", "target": "Secondary or less", "value": 29, "province_territory": "Yukon", "year": "2019"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "Alberta", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 855, "province_territory": "Alberta", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 9210, "province_territory": "Alberta", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 3450, "province_territory": "Alberta", "year": "2020"}, {"source": "Study", "target": "Education level not stated", "value": 26, "province_territory": "British Columbia", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 4030, "province_territory": "British Columbia", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 44450, "province_territory": "British Columbia", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 14135, "province_territory": "British Columbia", "year": "2020"}, {"source": "Study", "target": "Education level not stated", "value": 8, "province_territory": "Manitoba", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 565, "province_territory": "Manitoba", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 7295, "province_territory": "Manitoba", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 1320, "province_territory": "Manitoba", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 105, "province_territory": "New Brunswick", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 1705, "province_territory": "New Brunswick", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 535, "province_territory": "New Brunswick", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 29, "province_territory": "Newfoundland and Labrador", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 1240, "province_territory": "Newfoundland and Labrador", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 175, "province_territory": "Newfoundland and Labrador", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 8, "province_territory": "Northwest Territories", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 12, "province_territory": "Northwest Territories", "year": "2020"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "Nova Scotia", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 385, "province_territory": "Nova Scotia", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 3840, "province_territory": "Nova Scotia", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 1065, "province_territory": "Nova Scotia", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 4, "province_territory": "Nunavut", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 2, "province_territory": "Nunavut", "year": "2020"}, {"source": "Study", "target": "Education level not stated", "value": 39, "province_territory": "Ontario", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 7600, "province_territory": "Ontario", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 97485, "province_territory": "Ontario", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 21980, "province_territory": "Ontario", "year": "2020"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Prince Edward Island", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 268, "province_territory": "Prince Edward Island", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 760, "province_territory": "Prince Edward Island", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 295, "province_territory": "Prince Edward Island", "year": "2020"}, {"source": "Study", "target": "Education level not stated", "value": 569, "province_territory": "Province/territory not stated Total", "year": "2020"}, {"source": "Study", "target": "Education level not stated", "value": 14, "province_territory": "Quebec", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 5980, "province_territory": "Quebec", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 35115, "province_territory": "Quebec", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 4060, "province_territory": "Quebec", "year": "2020"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Saskatchewan", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 127, "province_territory": "Saskatchewan", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 2650, "province_territory": "Saskatchewan", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 905, "province_territory": "Saskatchewan", "year": "2020"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Yukon", "year": "2020"}, {"source": "Study", "target": "Other Studies", "value": 4, "province_territory": "Yukon", "year": "2020"}, {"source": "Study", "target": "Post Secondary", "value": 78, "province_territory": "Yukon", "year": "2020"}, {"source": "Study", "target": "Secondary or less", "value": 39, "province_territory": "Yukon", "year": "2020"}, {"source": "Study", "target": "Education level not stated", "value": 16, "province_territory": "Alberta", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 1215, "province_territory": "Alberta", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 18080, "province_territory": "Alberta", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 5110, "province_territory": "Alberta", "year": "2021"}, {"source": "Study", "target": "Education level not stated", "value": 61, "province_territory": "British Columbia", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 8525, "province_territory": "British Columbia", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 67120, "province_territory": "British Columbia", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 22065, "province_territory": "British Columbia", "year": "2021"}, {"source": "Study", "target": "Education level not stated", "value": 8, "province_territory": "Manitoba", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 980, "province_territory": "Manitoba", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 9915, "province_territory": "Manitoba", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 2450, "province_territory": "Manitoba", "year": "2021"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "New Brunswick", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 174, "province_territory": "New Brunswick", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 4390, "province_territory": "New Brunswick", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 1505, "province_territory": "New Brunswick", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 43, "province_territory": "Newfoundland and Labrador", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 2795, "province_territory": "Newfoundland and Labrador", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 550, "province_territory": "Newfoundland and Labrador", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 14, "province_territory": "Northwest Territories", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 16, "province_territory": "Northwest Territories", "year": "2021"}, {"source": "Study", "target": "Education level not stated", "value": 6, "province_territory": "Nova Scotia", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 795, "province_territory": "Nova Scotia", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 7935, "province_territory": "Nova Scotia", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 1495, "province_territory": "Nova Scotia", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 2, "province_territory": "Nunavut", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 6, "province_territory": "Nunavut", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 2, "province_territory": "Nunavut", "year": "2021"}, {"source": "Study", "target": "Education level not stated", "value": 58, "province_territory": "Ontario", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 16555, "province_territory": "Ontario", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 186595, "province_territory": "Ontario", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 25815, "province_territory": "Ontario", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 209, "province_territory": "Prince Edward Island", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 1235, "province_territory": "Prince Edward Island", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 485, "province_territory": "Prince Edward Island", "year": "2021"}, {"source": "Study", "target": "Education level not stated", "value": 2700, "province_territory": "Province/territory not stated Total", "year": "2021"}, {"source": "Study", "target": "Education level not stated", "value": 18, "province_territory": "Quebec", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 6480, "province_territory": "Quebec", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 53615, "province_territory": "Quebec", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 6430, "province_territory": "Quebec", "year": "2021"}, {"source": "Study", "target": "Education level not stated", "value": 6, "province_territory": "Saskatchewan", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 267, "province_territory": "Saskatchewan", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 4965, "province_territory": "Saskatchewan", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 1385, "province_territory": "Saskatchewan", "year": "2021"}, {"source": "Study", "target": "Other Studies", "value": 8, "province_territory": "Yukon", "year": "2021"}, {"source": "Study", "target": "Post Secondary", "value": 118, "province_territory": "Yukon", "year": "2021"}, {"source": "Study", "target": "Secondary or less", "value": 77, "province_territory": "Yukon", "year": "2021"}, {"source": "Study", "target": "Education level not stated", "value": 10, "province_territory": "Alberta", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 1320, "province_territory": "Alberta", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 20480, "province_territory": "Alberta", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 7630, "province_territory": "Alberta", "year": "2022"}, {"source": "Study", "target": "Education level not stated", "value": 36, "province_territory": "British Columbia", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 9440, "province_territory": "British Columbia", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 80035, "province_territory": "British Columbia", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 24820, "province_territory": "British Columbia", "year": "2022"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "Manitoba", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 1100, "province_territory": "Manitoba", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 11210, "province_territory": "Manitoba", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 3240, "province_territory": "Manitoba", "year": "2022"}, {"source": "Study", "target": "Education level not stated", "value": 6, "province_territory": "New Brunswick", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 134, "province_territory": "New Brunswick", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 5625, "province_territory": "New Brunswick", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 2085, "province_territory": "New Brunswick", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 56, "province_territory": "Newfoundland and Labrador", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 3105, "province_territory": "Newfoundland and Labrador", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 850, "province_territory": "Newfoundland and Labrador", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 14, "province_territory": "Northwest Territories", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 28, "province_territory": "Northwest Territories", "year": "2022"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Nova Scotia", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 980, "province_territory": "Nova Scotia", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 9925, "province_territory": "Nova Scotia", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 2575, "province_territory": "Nova Scotia", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 4, "province_territory": "Nunavut", "year": "2022"}, {"source": "Study", "target": "Education level not stated", "value": 70, "province_territory": "Ontario", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 21985, "province_territory": "Ontario", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 247105, "province_territory": "Ontario", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 32970, "province_territory": "Ontario", "year": "2022"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "Prince Edward Island", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 230, "province_territory": "Prince Edward Island", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 1630, "province_territory": "Prince Edward Island", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 615, "province_territory": "Prince Edward Island", "year": "2022"}, {"source": "Study", "target": "Education level not stated", "value": 4490, "province_territory": "Province/territory not stated Total", "year": "2022"}, {"source": "Study", "target": "Education level not stated", "value": 11, "province_territory": "Quebec", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 6640, "province_territory": "Quebec", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 52140, "province_territory": "Quebec", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 7050, "province_territory": "Quebec", "year": "2022"}, {"source": "Study", "target": "Education level not stated", "value": 8, "province_territory": "Saskatchewan", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 350, "province_territory": "Saskatchewan", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 6300, "province_territory": "Saskatchewan", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 2060, "province_territory": "Saskatchewan", "year": "2022"}, {"source": "Study", "target": "Other Studies", "value": 2, "province_territory": "Yukon", "year": "2022"}, {"source": "Study", "target": "Post Secondary", "value": 73, "province_territory": "Yukon", "year": "2022"}, {"source": "Study", "target": "Secondary or less", "value": 94, "province_territory": "Yukon", "year": "2022"}, {"source": "Study", "target": "Education level not stated", "value": 23, "province_territory": "Alberta", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 1605, "province_territory": "Alberta", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 28960, "province_territory": "Alberta", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 12500, "province_territory": "Alberta", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 33, "province_territory": "British Columbia", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 8105, "province_territory": "British Columbia", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 93820, "province_territory": "British Columbia", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 28725, "province_territory": "British Columbia", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 10, "province_territory": "Manitoba", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 1090, "province_territory": "Manitoba", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 14190, "province_territory": "Manitoba", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 4740, "province_territory": "Manitoba", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 8, "province_territory": "New Brunswick", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 209, "province_territory": "New Brunswick", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 7920, "province_territory": "New Brunswick", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 3075, "province_territory": "New Brunswick", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Newfoundland and Labrador", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 83, "province_territory": "Newfoundland and Labrador", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 3295, "province_territory": "Newfoundland and Labrador", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 885, "province_territory": "Newfoundland and Labrador", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 2, "province_territory": "Northwest Territories", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 16, "province_territory": "Northwest Territories", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 36, "province_territory": "Northwest Territories", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 14, "province_territory": "Nova Scotia", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 815, "province_territory": "Nova Scotia", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 11695, "province_territory": "Nova Scotia", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 3880, "province_territory": "Nova Scotia", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 10, "province_territory": "Nunavut", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 2, "province_territory": "Nunavut", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 91, "province_territory": "Ontario", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 23810, "province_territory": "Ontario", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 302100, "province_territory": "Ontario", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 47730, "province_territory": "Ontario", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Prince Edward Island", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 495, "province_territory": "Prince Edward Island", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 1900, "province_territory": "Prince Edward Island", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 770, "province_territory": "Prince Edward Island", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 5585, "province_territory": "Province/territory not stated Total", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 19, "province_territory": "Quebec", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 8930, "province_territory": "Quebec", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 61595, "province_territory": "Quebec", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 10300, "province_territory": "Quebec", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 13, "province_territory": "Saskatchewan", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 455, "province_territory": "Saskatchewan", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 8875, "province_territory": "Saskatchewan", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 3030, "province_territory": "Saskatchewan", "year": "2023"}, {"source": "Study", "target": "Other Studies", "value": 10, "province_territory": "Yukon", "year": "2023"}, {"source": "Study", "target": "Post Secondary", "value": 113, "province_territory": "Yukon", "year": "2023"}, {"source": "Study", "target": "Secondary or less", "value": 142, "province_territory": "Yukon", "year": "2023"}, {"source": "Study", "target": "Education level not stated", "value": 18, "province_territory": "Alberta", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 1435, "province_territory": "Alberta", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 25940, "province_territory": "Alberta", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 13040, "province_territory": "Alberta", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 49, "province_territory": "British Columbia", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 5840, "province_territory": "British Columbia", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 71830, "province_territory": "British Columbia", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 26505, "province_territory": "British Columbia", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 14, "province_territory": "Manitoba", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 755, "province_territory": "Manitoba", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 10640, "province_territory": "Manitoba", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 4430, "province_territory": "Manitoba", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "New Brunswick", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 114, "province_territory": "New Brunswick", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 5385, "province_territory": "New Brunswick", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 2820, "province_territory": "New Brunswick", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "Newfoundland and Labrador", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 56, "province_territory": "Newfoundland and Labrador", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 2270, "province_territory": "Newfoundland and Labrador", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 1155, "province_territory": "Newfoundland and Labrador", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 34, "province_territory": "Northwest Territories", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 42, "province_territory": "Northwest Territories", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "Nova Scotia", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 560, "province_territory": "Nova Scotia", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 7205, "province_territory": "Nova Scotia", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 3415, "province_territory": "Nova Scotia", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 6, "province_territory": "Nunavut", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 11, "province_territory": "Nunavut", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 95, "province_territory": "Ontario", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 13860, "province_territory": "Ontario", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 196800, "province_territory": "Ontario", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 46510, "province_territory": "Ontario", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 280, "province_territory": "Prince Edward Island", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 1145, "province_territory": "Prince Edward Island", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 800, "province_territory": "Prince Edward Island", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 4955, "province_territory": "Province/territory not stated Total", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 20, "province_territory": "Quebec", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 12855, "province_territory": "Quebec", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 50735, "province_territory": "Quebec", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 11120, "province_territory": "Quebec", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 8, "province_territory": "Saskatchewan", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 330, "province_territory": "Saskatchewan", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 6160, "province_territory": "Saskatchewan", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 3175, "province_territory": "Saskatchewan", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 6, "province_territory": "Yukon", "year": "2024"}, {"source": "Study", "target": "Other Studies", "value": 10, "province_territory": "Yukon", "year": "2024"}, {"source": "Study", "target": "Post Secondary", "value": 110, "province_territory": "Yukon", "year": "2024"}, {"source": "Study", "target": "Secondary or less", "value": 97, "province_territory": "Yukon", "year": "2024"}, {"source": "Study", "target": "Education level not stated", "value": 10, "province_territory": "Alberta", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 435, "province_territory": "Alberta", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 7305, "province_territory": "Alberta", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 7100, "province_territory": "Alberta", "year": "2025"}, {"source": "Study", "target": "Education level not stated", "value": 10, "province_territory": "British Columbia", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 1540, "province_territory": "British Columbia", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 22735, "province_territory": "British Columbia", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 10385, "province_territory": "British Columbia", "year": "2025"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Manitoba", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 220, "province_territory": "Manitoba", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 4230, "province_territory": "Manitoba", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 2155, "province_territory": "Manitoba", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 59, "province_territory": "New Brunswick", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 2060, "province_territory": "New Brunswick", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 1310, "province_territory": "New Brunswick", "year": "2025"}, {"source": "Study", "target": "Education level not stated", "value": 4, "province_territory": "Newfoundland and Labrador", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 10, "province_territory": "Newfoundland and Labrador", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 715, "province_territory": "Newfoundland and Labrador", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 555, "province_territory": "Newfoundland and Labrador", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 4, "province_territory": "Northwest Territories", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 31, "province_territory": "Northwest Territories", "year": "2025"}, {"source": "Study", "target": "Education level not stated", "value": 2, "province_territory": "Nova Scotia", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 245, "province_territory": "Nova Scotia", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 2275, "province_territory": "Nova Scotia", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 1435, "province_territory": "Nova Scotia", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 2, "province_territory": "Nunavut", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 6, "province_territory": "Nunavut", "year": "2025"}, {"source": "Study", "target": "Education level not stated", "value": 22, "province_territory": "Ontario", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 2965, "province_territory": "Ontario", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 54230, "province_territory": "Ontario", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 20805, "province_territory": "Ontario", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 197, "province_territory": "Prince Edward Island", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 380, "province_territory": "Prince Edward Island", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 275, "province_territory": "Prince Edward Island", "year": "2025"}, {"source": "Study", "target": "Education level not stated", "value": 1435, "province_territory": "Province/territory not stated Total", "year": "2025"}, {"source": "Study", "target": "Education level not stated", "value": 10, "province_territory": "Quebec", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 4900, "province_territory": "Quebec", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 14945, "province_territory": "Quebec", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 5585, "province_territory": "Quebec", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 67, "province_territory": "Saskatchewan", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 1805, "province_territory": "Saskatchewan", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 1550, "province_territory": "Saskatchewan", "year": "2025"}, {"source": "Study", "target": "Other Studies", "value": 2, "province_territory": "Yukon", "year": "2025"}, {"source": "Study", "target": "Post Secondary", "value": 37, "province_territory": "Yukon", "year": "2025"}, {"source": "Study", "target": "Secondary or less", "value": 32, "province_territory": "Yukon", "year": "2025"}];
    const COLOR_SCHEMA = {"Post Secondary": "#e74c3c", "Secondary or less": "#3498db", "Other Studies": "#2ecc71", "Education level not stated": "#f39c12"};
    // END DATA
  </script>

  <script>
    // Initialize ECharts
    const chartDom = document.getElementById('chart');
    const myChart = echarts.init(chartDom);

    const provinceSel = document.getElementById('provinceSelect');
    const yearSel = document.getElementById('yearSelect');
    const summaryEl = document.getElementById('summary');
    const zeroValuesEl = document.getElementById('zeroValues');
    const zeroValuesListEl = document.getElementById('zeroValuesList');

    // Format numbers
    function formatNumber(num) {
      if (num >= 1000000) return (num / 1000000).toFixed(1).replace(/\.0$/, '') + 'M';
      if (num >= 1000) return (num / 1000).toFixed(1).replace(/\.0$/, '') + 'k';
      return num.toString();
    }

    // Color scheme for different branches from root
    const branchColors = [
      '#e74c3c',  // Red
      '#3498db',  // Blue
      '#2ecc71',  // Green
      '#f39c12',  // Orange
      '#9b59b6',  // Purple
      '#1abc9c',  // Turquoise
      '#e67e22',  // Dark Orange
      '#34495e',  // Dark Blue
      '#e91e63',  // Pink
      '#00bcd4'   // Cyan
    ];

    function init() {
      // Build filter lists from links
      const provs = Array.from(new Set(LINKS.map(l => String(l.province_territory)))).sort();
      const years = Array.from(new Set(LINKS.map(l => String(l.year)))).sort((a,b)=>a.localeCompare(b));

      for (const p of provs) {
        const opt = document.createElement('option');
        opt.value = p;
        opt.textContent = p;
        provinceSel.appendChild(opt);
      }
      for (const y of years) {
        const opt = document.createElement('option');
        opt.value = y;
        opt.textContent = y;
        yearSel.appendChild(opt);
      }

      provinceSel.addEventListener('change', render);
      yearSel.addEventListener('change', render);

      render();
    }

    // Function to assign colors to branches using pre-assigned color schema
    function assignBranchColors(links) {
      const nodeColors = {};
      const linkColors = {};
      
      // Find root node (Study)
      const rootNode = 'Study';
      nodeColors[rootNode] = '#808080'; // Gray color for root node
      
      // Get all direct children of root
      const rootChildren = links
        .filter(link => link.source === rootNode)
        .map(link => link.target);
      
      // Assign colors using pre-assigned color schema
      rootChildren.forEach((child) => {
        // Use pre-assigned color from COLOR_SCHEMA
        const branchColor = COLOR_SCHEMA[child];
        
        if (branchColor) {
          // Color the direct child
          nodeColors[child] = branchColor;
          
          // Color the link from root to child
          const rootLink = links.find(link => link.source === rootNode && link.target === child);
          if (rootLink) {
            linkColors[`${rootNode}-${child}`] = branchColor;
          }
          
          // Recursively color all downstream nodes and links
          colorDownstream(child, branchColor, links, nodeColors, linkColors);
        }
      });
      
      return { nodeColors, linkColors };
    }
    
    function colorDownstream(node, color, links, nodeColors, linkColors) {
      // Find all children of this node
      const children = links
        .filter(link => link.source === node)
        .map(link => link.target);
      
      children.forEach(child => {
        // Color the child node
        nodeColors[child] = color;
        
        // Color the link
        const linkKey = `${node}-${child}`;
        linkColors[linkKey] = color;
        
        // Recursively color downstream
        colorDownstream(child, color, links, nodeColors, linkColors);
      });
    }

    function render() {
      const p = provinceSel.value;
      const y = yearSel.value;

      // Filter links
      const filtered = LINKS.filter(l => 
        (p === 'ALL' || String(l.province_territory) === p) &&
        (y === 'ALL' || String(l.year) === y)
      );

      // Aggregate links by source-target pairs
      const edgeMap = new Map();
      for (const row of filtered) {
        const key = `${row.source}-${row.target}`;
        if (!edgeMap.has(key)) {
          edgeMap.set(key, {
            source: row.source,
            target: row.target,
            value: 0
          });
        }
        edgeMap.get(key).value += row.value;
      }
      const aggregatedLinks = Array.from(edgeMap.values());

      // Assign colors to branches
      const { nodeColors, linkColors } = assignBranchColors(aggregatedLinks);

      // Update summary
      summaryEl.textContent = `${p==='ALL'?'All provinces':p} · ${y==='ALL'?'All years':y}`;

      // Create node level mapping and calculate node values
      const nodeLevels = {};
      const nodeValues = {};
      
      // Calculate total value for each node (only count outgoing flow to avoid double counting)
      aggregatedLinks.forEach(link => {
        // For source nodes, count outgoing flow
        nodeValues[link.source] = (nodeValues[link.source] || 0) + link.value;
        // For target nodes, only count if they don't have outgoing flow (leaf nodes)
        if (!nodeValues[link.target]) {
          nodeValues[link.target] = 0;
        }
        // Only add incoming flow if this node has no outgoing flow
        const hasOutgoing = aggregatedLinks.some(l => l.source === link.target);
        if (!hasOutgoing) {
          nodeValues[link.target] += link.value;
        }
      });
      
      // Filter out zero value nodes from chart data
      const nodesWithValues = NODES.filter(node => (nodeValues[node] || 0) > 0);
      
      // Filter links to only include those connecting nodes with values
      const filteredLinks = aggregatedLinks.filter(link => 
        (nodeValues[link.source] || 0) > 0 && (nodeValues[link.target] || 0) > 0
      );
      
      // Use explicit level assignment - Study has only 2 levels: [Study] + study_level
      let currentLevel = 0;
      let nodeIndex = 0;
      
      // Level 0: Study (first node)
      if (NODES.length > 0) {
        nodeLevels[NODES[0]] = 0;
        nodeIndex = 1;
      }
      
      // Find the boundaries between levels by looking at the data structure
      const studyLevelNodes = new Set();
      
      // Analyze links to determine which nodes belong to which category
      aggregatedLinks.forEach(link => {
        // If source is Study, target is study_level
        if (link.source === 'Study') {
          studyLevelNodes.add(link.target);
        }
      });
      
      // Assign levels based on category membership
      NODES.forEach(node => {
        if (node === 'Study') {
          nodeLevels[node] = 0;
        } else if (studyLevelNodes.has(node)) {
          nodeLevels[node] = 1;
        } else {
          // Fallback: try to infer from position in NODES array
          const index = NODES.indexOf(node);
          if (index <= 1) nodeLevels[node] = 1;
          else nodeLevels[node] = 1;
        }
      });
      

      // Create parent-child mapping for hierarchical sorting
      const parentMap = new Map(); // childId -> parentId
      const childrenMap = new Map(); // parentId -> Set of childIds
      
      aggregatedLinks.forEach(link => {
        parentMap.set(link.target, link.source);
        if (!childrenMap.has(link.source)) {
          childrenMap.set(link.source, new Set());
        }
        childrenMap.get(link.source).add(link.target);
      });
      
      // Calculate node order: first by level, then by value within level, then by parent order
      const nodeOrder = new Map();
      let orderCounter = 0;
      
      // Get nodes by level
      const nodesByLevel = new Map();
      NODES.forEach(node => {
        const level = nodeLevels[node] || 0;
        if (!nodesByLevel.has(level)) {
          nodesByLevel.set(level, []);
        }
        nodesByLevel.get(level).push(node);
      });
      
      // Sort each level hierarchically
      const maxLevel = Math.max(...Array.from(nodesByLevel.keys()));
      for (let level = 0; level <= maxLevel; level++) {
        const nodesAtLevel = nodesByLevel.get(level) || [];
        
        if (level === 0) {
          // Level 0: just assign order
          nodesAtLevel.forEach(node => {
            nodeOrder.set(node, orderCounter++);
          });
        } else if (level === 1) {
          // Level 1: sort by value (descending) - these are direct children of Study
          const sortedLevel1 = nodesAtLevel.sort((a, b) => (nodeValues[b] || 0) - (nodeValues[a] || 0));
          sortedLevel1.forEach(node => {
            nodeOrder.set(node, orderCounter++);
          });
        } else {
          // Group by parent, maintaining parent order
          const grouped = new Map(); // parentId -> children
          const orphans = []; // nodes without parents
          
          for (const node of nodesAtLevel) {
            const parentId = parentMap.get(node);
            if (parentId === undefined) {
              orphans.push(node);
            } else {
              if (!grouped.has(parentId)) {
                grouped.set(parentId, []);
              }
              grouped.get(parentId).push(node);
            }
          }
          
          // Sort orphans by value
          orphans.sort((a, b) => (nodeValues[b] || 0) - (nodeValues[a] || 0));
          orphans.forEach(node => {
            nodeOrder.set(node, orderCounter++);
          });
          
          // Get parents sorted by their order
          const sortedParents = Array.from(grouped.keys())
            .sort((a, b) => (nodeOrder.get(a) || 0) - (nodeOrder.get(b) || 0));
          
          
          // Process children in parent order
          for (const parentId of sortedParents) {
            const children = grouped.get(parentId);
            // Sort children within parent by value (descending)
            children.sort((a, b) => (nodeValues[b] || 0) - (nodeValues[a] || 0));
            
            
            children.forEach(node => {
              nodeOrder.set(node, orderCounter++);
            });
          }
        }
      }
      
      // Sort nodes using the hierarchical order (only nodes with values)
      const sortedNodes = nodesWithValues.slice().sort((a, b) => {
        const orderA = nodeOrder.get(a) || 0;
        const orderB = nodeOrder.get(b) || 0;
        return orderA - orderB;
      });

      // Create ECharts option
      const option = {
        tooltip: {
          trigger: 'item',
          triggerOn: 'click',
          formatter: function(params) {
            if (params.dataType === 'node') {
              const nodeName = params.name;
              const nodeValue = params.value || 0;
              const fullValue = nodeValue.toLocaleString();
              
              // Find parent node and calculate percentage
              const parentLink = aggregatedLinks.find(link => link.target === nodeName);
              let percentage = '';
              if (parentLink) {
                const parentValue = nodeValues[parentLink.source] || 0;
                if (parentValue > 0) {
                  const percent = ((nodeValue / parentValue) * 100).toFixed(1);
                  percentage = ` (${percent}%)`;
                }
              }
              
              return `${nodeName}<br/>${fullValue}${percentage}`;
            } else if (params.dataType === 'edge') {
              return `${params.data.source} → ${params.data.target}<br/>Value: ${formatNumber(params.data.value)}`;
            }
            return '';
          }
        },
        series: [
          {
            type: 'sankey',
            left: 100,
            right: 50,
            top: 20,
            bottom: 20,
            data: sortedNodes.map(node => ({
              name: node,
              itemStyle: {
                color: nodeColors[node] || '#999'
              },
              label: {
                position: 'left',
                align: 'right',
                textStyle: {
                  textBorderWidth: 0,
                  textShadowBlur: 0,
                  textShadowColor: 'transparent',
                  textBorderColor: 'transparent',
                  backgroundColor: 'transparent',
                  borderColor: 'transparent',
                  borderWidth: 0
                },
                formatter: function(params) {
                  const nodeName = params.name;
                  const nodeValue = nodeValues[nodeName] || 0;
                  const formattedValue = formatNumber(nodeValue);
                  
                  // Find parent node and calculate percentage
                  const parentLink = aggregatedLinks.find(link => link.target === nodeName);
                  let valuePart;
                  if (parentLink) {
                    const parentValue = nodeValues[parentLink.source] || 0;
                    const percentage = parentValue > 0 ? ((nodeValue / parentValue) * 100).toFixed(1) : '0.0';
                    valuePart = ` (${formattedValue}, ${percentage}%)`;
                  } else {
                    valuePart = ` (${formattedValue})`;
                  }
                  
                  // Calculate how much space we have for the node name
                  const maxChars = 60;
                  const availableForName = maxChars - valuePart.length;
                  
                  // Truncate only the node name, keep values and percentages
                  const truncatedName = nodeName.length > availableForName ? 
                    nodeName.substring(0, availableForName) + '...' : nodeName;
                  
                  return truncatedName + valuePart;
                }
              }
            })),
            links: filteredLinks.map(link => ({
              ...link,
              lineStyle: {
                color: linkColors[`${link.source}-${link.target}`] || '#ccc',
                opacity: 0.4
              }
            })),
            emphasis: {
              focus: 'trajectory'
            },
            lineStyle: {
              curveness: 0.3
            },
            nodeAlign: 'left',
            nodeGap: 14,
            nodeWidth: 20,
            layoutIterations: 0
          }
        ]
      };

      // Set the option and render
      myChart.setOption(option, true);
      
      // Update zero values list
      updateZeroValuesList(aggregatedLinks, nodeValues, parentMap);
    }
    
    function updateZeroValuesList(links, nodeValues, parentMap) {
      // Find all nodes that have zero value
      const zeroValueNodes = NODES.filter(node => (nodeValues[node] || 0) === 0);
      
      if (zeroValueNodes.length > 0) {
        // Show the zero values section
        zeroValuesEl.style.display = 'block';
        
        // Clear and populate the list
        zeroValuesListEl.innerHTML = '';
        
        // Create hierarchy paths for zero value nodes
        const hierarchyPaths = zeroValueNodes.map(node => {
          return buildHierarchyPath(node, parentMap);
        });
        
        // Sort alphabetically
        hierarchyPaths.sort();
        
        // Create bullet point list with colored squares
        const ul = document.createElement('ul');
        ul.style.cssText = 'margin: 0; padding-left: 20px; list-style: none;';
        
        hierarchyPaths.forEach(path => {
          const li = document.createElement('li');
          li.style.cssText = 'margin: 4px 0; font-size: 13px; color: #495057; display: flex; align-items: center;';
          
          // Extract the top-level node from the path (first part before ' > ')
          const topLevelNode = path.split(' > ')[0];
          const bulletColor = COLOR_SCHEMA[topLevelNode] || '#999999';
          
          // Create colored square bullet
          const bullet = document.createElement('span');
          bullet.style.cssText = `display: inline-block; width: 12px; height: 12px; background-color: ${bulletColor}; margin-right: 8px; border-radius: 2px;`;
          
          // Create text content
          const textSpan = document.createElement('span');
          textSpan.textContent = path;
          
          li.appendChild(bullet);
          li.appendChild(textSpan);
          ul.appendChild(li);
        });
        
        zeroValuesListEl.appendChild(ul);
      } else {
        // Hide the zero values section
        zeroValuesEl.style.display = 'none';
      }
    }
    
    function buildHierarchyPath(node, parentMap) {
      // Create parent map from original unfiltered data for hierarchy building
      const originalParentMap = new Map();
      LINKS.forEach(link => {
        originalParentMap.set(link.target, link.source);
      });
      
      // Build path from node up to level 1 (first level after root)
      const path = [];
      let currentNode = node;
      
      while (currentNode && currentNode !== 'Study') {
        path.unshift(currentNode);
        currentNode = originalParentMap.get(currentNode);
        
        // Stop if we reach level 1 (first level after Study)
        if (currentNode === 'Study' || !currentNode) {
          break;
        }
      }
      
      // Add (0) suffix to the final node
      if (path.length > 0) {
        path[path.length - 1] = `${path[path.length - 1]} (0)`;
      }
      
      // Special case: if this is a top-level node (direct child of Study),
      // ensure the path includes the node name twice for proper color lookup
      if (path.length === 1) {
        // This is a top-level node, create path like "Node > Node (0)"
        const topLevelNode = path[0].replace(' (0)', '');
        return `${topLevelNode} > ${path[0]}`;
      }
      
      return path.join(' > ');
    }

    // Handle window resize
    window.addEventListener('resize', function() {
      myChart.resize();
    });

    init();
  </script>
</body>
</html>